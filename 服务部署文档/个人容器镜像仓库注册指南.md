# 个人容器镜像仓库注册指南

## 一、免费容器镜像仓库对比

### 1. 腾讯云容器镜像服务（TCR）

**个人版 - 完全免费**

✅ **优点：**
- 个人版**限额免费使用**
- 无需付费，适合个人开发者
- 国内访问速度快
- 与腾讯云其他服务集成良好

❌ **限制：**
- 不承诺 SLA（服务等级协议）
- 功能相对企业版有限
- 存储在 COS（对象存储），可能产生少量存储费用

**个人版免费额度：**
- 命名空间：3 个
- 镜像仓库：无限制
- 存储空间：10GB（超出按 COS 计费）
- 流量：内网流量免费，公网流量按量计费

**官方文档：** https://cloud.tencent.com/document/product/1141

---

### 2. 阿里云容器镜像服务（ACR）

**个人版 - 完全免费**

✅ **优点：**
- 个人版**完全免费**
- 功能丰富，文档完善
- 国内访问速度快
- 社区活跃，教程多

❌ **限制：**
- 不承诺 SLA
- 有命名空间和仓库数量限制

**个人版免费额度：**
- 命名空间：3 个
- 镜像仓库：300 个
- 存储空间：无限制（但有流量限制）
- 流量：内网流量免费，公网流量有限额

**官方文档：** https://help.aliyun.com/zh/acr/

---

### 3. Docker Hub

**免费版**

✅ **优点：**
- 全球最大的容器镜像仓库
- 公开镜像丰富
- 国际通用

❌ **限制：**
- 国内访问速度慢（经常超时）
- 免费版只能创建 1 个私有仓库
- 有拉取次数限制（匿名用户 100 次/6 小时，认证用户 200 次/6 小时）

**免费额度：**
- 公开仓库：无限制
- 私有仓库：1 个
- 存储空间：无限制

---

### 4. GitHub Container Registry (GHCR)

**完全免费**

✅ **优点：**
- 与 GitHub 深度集成
- 公开镜像完全免费
- 私有镜像也免费（有存储限额）

❌ **限制：**
- 国内访问速度一般
- 需要 GitHub 账号

**免费额度：**
- 公开镜像：无限制
- 私有镜像：500MB 存储（免费账号）

---

## 二、推荐方案

### 个人开发者推荐顺序：

1. **腾讯云 TCR 个人版**（首选）
   - ✅ 完全免费
   - ✅ 国内访问快
   - ✅ 10GB 存储足够个人使用
   - ✅ 配置简单

2. **阿里云 ACR 个人版**（备选）
   - ✅ 完全免费
   - ✅ 国内访问快
   - ✅ 300 个仓库足够使用
   - ✅ 文档丰富

3. **GitHub Container Registry**（国际项目）
   - ✅ 与 GitHub 集成
   - ⚠️ 国内访问速度一般

4. **Docker Hub**（不推荐）
   - ❌ 国内访问慢
   - ❌ 只有 1 个私有仓库

---

## 三、腾讯云 TCR 个人版注册步骤

### 1. 注册腾讯云账号

访问：https://cloud.tencent.com/

- 使用手机号或微信注册
- 完成实名认证（需要身份证）

### 2. 开通容器镜像服务

访问：https://console.cloud.tencent.com/tcr

- 点击"立即使用"
- 选择"个人版"
- 同意服务协议

### 3. 创建命名空间

在个人版控制台：
- 点击"命名空间"
- 点击"新建"
- 输入命名空间名称，例如：`myproject`
- 选择"私有"（只有你能访问）

### 4. 创建镜像仓库

- 点击"镜像仓库"
- 点击"新建"
- 选择命名空间：`myproject`
- 输入仓库名称，例如：`pos1starter`
- 选择"私有"
- 完成创建

### 5. 获取访问凭证

- 点击右上角用户名
- 选择"访问管理" → "访问密钥"
- 创建或查看 SecretId 和 SecretKey

或者使用专门的容器镜像服务凭证：
- 在 TCR 控制台
- 点击"访问凭证"
- 创建长期访问凭证
- 记录用户名和密码

### 6. 本地登录测试

```bash
# 登录腾讯云 TCR
docker login ccr.ccs.tencentyun.com

# 输入用户名和密码

# 测试推送镜像
docker tag myimage:latest ccr.ccs.tencentyun.com/myproject/myimage:latest
docker push ccr.ccs.tencentyun.com/myproject/myimage:latest
```

---

## 四、阿里云 ACR 个人版注册步骤

### 1. 注册阿里云账号

访问：https://www.aliyun.com/

- 使用手机号注册
- 完成实名认证

### 2. 开通容器镜像服务

访问：https://cr.console.aliyun.com/

- 点击"个人实例"
- 同意服务协议
- 设置 Registry 登录密码（重要！）

### 3. 创建命名空间

- 点击"命名空间"
- 点击"创建命名空间"
- 输入命名空间名称，例如：`myproject`
- 选择"私有"

### 4. 创建镜像仓库

- 点击"镜像仓库"
- 点击"创建镜像仓库"
- 选择命名空间：`myproject`
- 输入仓库名称，例如：`pos1starter`
- 选择"本地仓库"
- 选择"私有"

### 5. 获取访问地址

阿里云 ACR 有多个地域，选择离你最近的：
- 华东1（杭州）：`registry.cn-hangzhou.aliyuncs.com`
- 华北2（北京）：`registry.cn-beijing.aliyuncs.com`
- 华南1（深圳）：`registry.cn-shenzhen.aliyuncs.com`

### 6. 本地登录测试

```bash
# 登录阿里云 ACR（以杭州为例）
docker login registry.cn-hangzhou.aliyuncs.com

# 输入阿里云账号和 Registry 密码

# 测试推送镜像
docker tag myimage:latest registry.cn-hangzhou.aliyuncs.com/myproject/myimage:latest
docker push registry.cn-hangzhou.aliyuncs.com/myproject/myimage:latest
```

---

## 五、在 Kubernetes 中配置

### 腾讯云 TCR

```bash
# 创建 Secret
kubectl create secret docker-registry tencent-ccr-secret \
  --docker-server=ccr.ccs.tencentyun.com \
  --docker-username=<你的用户名> \
  --docker-password=<你的密码> \
  --namespace=nms4cloud
```

或使用 YAML：

```yaml
apiVersion: v1
kind: Secret
metadata:
  name: tencent-ccr-secret
  namespace: nms4cloud
type: kubernetes.io/dockerconfigjson
data:
  .dockerconfigjson: <base64-encoded-docker-config>
```

### 阿里云 ACR

```bash
# 创建 Secret
kubectl create secret docker-registry aliyun-acr-secret \
  --docker-server=registry.cn-hangzhou.aliyuncs.com \
  --docker-username=<你的阿里云账号> \
  --docker-password=<你的Registry密码> \
  --namespace=nms4cloud
```

---

## 六、费用说明

### 腾讯云 TCR 个人版

**完全免费项目：**
- 镜像仓库管理：免费
- 内网流量：免费
- 10GB 存储：免费

**可能产生的费用：**
- 存储超过 10GB：按 COS 标准计费（约 0.118 元/GB/月）
- 公网下载流量：0.5 元/GB（建议使用内网）

**预估月费用：**
- 如果只存储 10GB 以内，使用内网：**0 元**
- 如果存储 20GB，使用内网：**约 1.2 元/月**

### 阿里云 ACR 个人版

**完全免费项目：**
- 镜像仓库管理：免费
- 内网流量：免费
- 存储空间：免费

**可能产生的费用：**
- 公网下载流量：有免费额度，超出后按量计费

**预估月费用：**
- 正常使用内网：**0 元**

---

## 七、常见问题

### 1. 个人版够用吗？

对于个人开发者和小团队：
- ✅ 3 个命名空间足够（可以按项目或环境划分）
- ✅ 10GB 存储足够（约 50-100 个镜像）
- ✅ 内网流量免费，速度快

### 2. 如何避免产生费用？

- 使用内网访问（Kubernetes 集群与镜像仓库在同一云平台）
- 定期清理旧镜像
- 控制镜像大小（使用 alpine 基础镜像）

### 3. 腾讯云和阿里云选哪个？

**选择腾讯云，如果：**
- 你的 Kubernetes 集群在腾讯云
- 你已经有腾讯云账号

**选择阿里云，如果：**
- 你的 Kubernetes 集群在阿里云
- 你已经有阿里云账号
- 你需要更多的镜像仓库数量（300 vs 无限制）

**建议：** 选择与你的 Kubernetes 集群同一云平台的镜像仓库，可以使用内网访问，速度快且免费。

### 4. 可以同时使用多个仓库吗？

可以！你可以：
- 腾讯云用于生产环境
- 阿里云用于测试环境
- GitHub Container Registry 用于开源项目

---

## 八、总结

**推荐方案：**

1. **注册腾讯云 TCR 个人版**（首选）
   - 完全免费
   - 10GB 存储足够个人使用
   - 国内访问速度快

2. **配置步骤：**
   - 注册腾讯云账号并实名认证
   - 开通 TCR 个人版
   - 创建命名空间和镜像仓库
   - 获取访问凭证
   - 在 Jenkins 和 Kubernetes 中配置

3. **预期费用：**
   - 正常使用：**0 元/月**
   - 存储超过 10GB：**约 0.12 元/GB/月**

需要我帮你创建具体的配置文件吗？
